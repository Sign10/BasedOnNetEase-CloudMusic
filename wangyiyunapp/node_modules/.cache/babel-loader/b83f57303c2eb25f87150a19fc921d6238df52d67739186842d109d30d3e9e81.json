{"ast":null,"code":"import { Vue3Marquee } from 'vue3-marquee';\nimport 'vue3-marquee/dist/style.css';\nimport { mapMutations, mapState } from 'vuex';\nexport default {\n  data() {\n    return {\n      isLyricShow: false\n    };\n  },\n  computed: {\n    ...mapState(['lyricList', 'currentTime', 'playListIndex', 'playList', 'duration']),\n    /*\r\n    getLyric() {\r\n        if (this.lyricList.lyric) {\r\n            let lyric = this.lyricList.lyric.slice(0, -1).match(/([^\\]]+)$/gm);\r\n            let millSec = this.lyricList.lyric.match(/\\d{2,3}(?=])/gm);\r\n            let sec = this.lyricList.lyric.match(/\\d{2}(?=\\.)/gm);\r\n            let min = this.lyricList.lyric.match(/\\d{2}(?=:)/gm);\r\n            console.log('分割了', min, sec, millSec, lyric);\r\n        }\r\n    }\r\n            */\n    getLyric() {\n      if (this.lyricList.lyric) {\n        let arr = this.lyricList.lyric.split(/[(\\r\\n)\\r\\n]+/).map((item, i) => {\n          let min = item.slice(1, 3);\n          let sec = item.slice(4, 6);\n          let mill = item.slice(7, 10);\n          let lrc = item.slice(11, item.length);\n          let time = parseInt(min) * 60 * 1000 + parseInt(sec) * 1000 + parseInt(mill);\n          if (isNaN(Number(mill))) {\n            mill = item.slice(7, 9);\n            lrc = item.slice(10, item.length);\n            time = parseInt(min) * 60 * 1000 + parseInt(sec) * 1000 + parseInt(mill);\n          }\n          return {\n            min,\n            sec,\n            mill,\n            lrc,\n            time\n          };\n        });\n        arr.forEach((item, i) => {\n          if (i === arr.length - 1 || isNaN(arr[i + 1].time)) {\n            item.next = 10000;\n          } else {\n            item.next = arr[i + 1].time;\n          }\n        });\n        return {\n          arr\n        };\n      }\n    }\n  },\n  mounted() {\n    this.addDuration();\n  },\n  watch: {\n    currentTime(val) {\n      let p = document.documentElement.querySelector('p.active');\n      if (p.offsetTop > 300 && p) {\n        this.$refs.musicLyric.scrollTop = p.offsetTop - 300;\n      }\n      if (val === this.duration) {\n        if (this.playListIndex === this.playList.length - 1) {\n          this.updatePlayListIndex(0);\n        } else {\n          this.updatePlayListIndex(0);\n        }\n      }\n    }\n  },\n  components: {\n    Vue3Marquee\n  },\n  methods: {\n    backHome() {\n      this.updatesonglistmore();\n      this.isLyricShow = false;\n    },\n    goPlay(num) {\n      let index = this.playListIndex + num;\n      if (index < 0) {\n        index = this.playList.length - 1;\n      } else if (index = this.playList.length - 1) {\n        index = 0;\n      }\n      this.updatePlayListIndex(index);\n    },\n    ...mapMutations(['updatesonglistmore', 'updatePlayListIndex'])\n  },\n  props: ['musiclist', 'play', 'isbtnShow', 'addDuration']\n};","map":{"version":3,"names":["Vue3Marquee","mapMutations","mapState","data","isLyricShow","computed","getLyric","lyricList","lyric","arr","split","map","item","i","min","slice","sec","mill","lrc","length","time","parseInt","isNaN","Number","forEach","next","mounted","addDuration","watch","currentTime","val","p","document","documentElement","querySelector","offsetTop","$refs","musicLyric","scrollTop","duration","playListIndex","playList","updatePlayListIndex","components","methods","backHome","updatesonglistmore","goPlay","num","index","props"],"sources":["D:\\桌面\\vue项目\\wangyiyunapp\\src\\components\\item\\MusicDetail.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <img :src=\"musiclist.al.picUrl\" alt=\"\" class=\"bgimg\">\r\n        <div class=\"detailTop\">\r\n            <div class=\"topleft\">\r\n                <svg class=\"icon3\" aria-hidden=\"true\" @click=\"backHome\">\r\n                    <use xlink:href=\"#icon-zuojiantou\"></use>\r\n                </svg>\r\n                <div class=\"leftMarquee\">\r\n                    <Vue3Marquee class=\"marquee\">{{ musiclist.name }}</Vue3Marquee>\r\n                    <div class=\"sonMarquee\">\r\n                        <span v-for='(item, idx) in musiclist.ar' :key=\"item\" class=\"arname\">\r\n                            {{ item.name }}\r\n                            {{ idx === musiclist.ar.length - 1 ? \"\" : \"/\" }}\r\n                        </span>\r\n                        <svg class=\"icon2\" aria-hidden=\"true\">\r\n                            <use xlink:href=\"#icon-youjiantou1\"></use>\r\n                        </svg>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n            <div class=\"topright\">\r\n                <svg class=\"icon1\" aria-hidden=\"true\">\r\n                    <use xlink:href=\"#icon-fenxiang\"></use>\r\n                </svg>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"detailContent\" v-show=\"!isLyricShow\" @click=\"isLyricShow = true\">\r\n            <img src=\"@/assets/needle-ab.png\" alt=\"\" class=\"img_needle\" :class=\"{ img_needle_active: !isbtnShow }\">\r\n            <img src=\"@/assets/cd.png\" alt=\"\" class=\"img_cd\">\r\n            <img :src=\"musiclist.al.picUrl\" alt=\"\" class=\"img_ar\"\r\n                :class=\"{ img_ar_active: !isbtnShow, img_ar_pause: isbtnShow }\">\r\n        </div>\r\n\r\n        <div class=\"Musiclyric\" ref=\"musicLyric\" v-show=\"isLyricShow\" @click=\"isLyricShow = false\">\r\n            <p v-for=\"(item, i) in getLyric.arr\" :key=item\r\n                :class=\"{ active: (currentTime * 1000 >= item.time && currentTime * 1000 < item.next) }\">\r\n                {{ item.lrc }}\r\n            </p>\r\n        </div>\r\n\r\n        <div class=\"detailFooter\">\r\n            <div class=\"footerTop\">\r\n                <svg class=\"icon5\" aria-hidden=\"true\">\r\n                    <use xlink:href=\"#icon-aixin\"></use>\r\n                </svg>\r\n                <svg class=\"icon5\" aria-hidden=\"true\">\r\n                    <use xlink:href=\"#icon-iconfontzhizuobiaozhun023146\"></use>\r\n                </svg>\r\n                <svg class=\"icon5\" aria-hidden=\"true\">\r\n                    <use xlink:href=\"#icon-yinlechangpian\"></use>\r\n                </svg>\r\n                <svg class=\"icon5\" aria-hidden=\"true\">\r\n                    <use xlink:href=\"#icon-iconfontzhizuobiaozhun023110\"></use>\r\n                </svg>\r\n                <svg class=\"icon5\" aria-hidden=\"true\">\r\n                    <use xlink:href=\"#icon-liebiao-\"></use>\r\n                </svg>\r\n            </div>\r\n\r\n            <div class=\"footerContent\">\r\n                <input type=\"range\" class=\"range\"  min=0  :max=\"duration\" v-model=\"currentTime\" step=\"0.05\">\r\n\r\n            </div>\r\n            <div class=\"footer\">\r\n                <svg class=\"icon5\" aria-hidden=\"true\">\r\n                    <use xlink:href=\"#icon-xunhuan\"></use>\r\n                </svg>\r\n                <svg class=\"icon5\" aria-hidden=\"true\" @click=\"goPlay(-1)\">\r\n                    <use xlink:href=\"#icon-shangyishoushangyige\"></use>\r\n                </svg>\r\n                <svg class=\"icon5 spc\" aria-hidden=\"true\" v-if=\"isbtnShow\" @click=\"play\">\r\n                    <use xlink:href=\"#icon-bofang1\"></use>\r\n                </svg>\r\n                <svg class=\"icon5 spc\" aria-hidden=\"true\" v-else @click=\"play\">\r\n                    <use xlink:href=\"#icon-zanting\"></use>\r\n                </svg>\r\n                <svg class=\"icon5\" aria-hidden=\"true\" @click=\"goPlay(1)\">\r\n                    <use xlink:href=\"#icon-xiayigexiayishou\"></use>\r\n                </svg>\r\n                <svg class=\"icon5\" aria-hidden=\"true\">\r\n                    <use xlink:href=\"#icon-zu\"></use>\r\n                </svg>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { Vue3Marquee } from 'vue3-marquee'\r\nimport 'vue3-marquee/dist/style.css'\r\nimport { mapMutations, mapState } from 'vuex'\r\nexport default {\r\n    data() {\r\n        return {\r\n            isLyricShow: false\r\n        }\r\n    },\r\n    computed: {\r\n        ...mapState(['lyricList', 'currentTime', 'playListIndex', 'playList','duration']),\r\n        /*\r\n        getLyric() {\r\n            if (this.lyricList.lyric) {\r\n                let lyric = this.lyricList.lyric.slice(0, -1).match(/([^\\]]+)$/gm);\r\n                let millSec = this.lyricList.lyric.match(/\\d{2,3}(?=])/gm);\r\n                let sec = this.lyricList.lyric.match(/\\d{2}(?=\\.)/gm);\r\n                let min = this.lyricList.lyric.match(/\\d{2}(?=:)/gm);\r\n                console.log('分割了', min, sec, millSec, lyric);\r\n            }\r\n        }\r\n                */\r\n        getLyric() {\r\n            if (this.lyricList.lyric) {\r\n                let arr = this.lyricList.lyric.split(/[(\\r\\n)\\r\\n]+/).map((item, i) => {\r\n                    let min = item.slice(1, 3);\r\n                    let sec = item.slice(4, 6);\r\n                    let mill = item.slice(7, 10);\r\n                    let lrc = item.slice(11, item.length);\r\n                    let time = parseInt(min) * 60 * 1000 + parseInt(sec) * 1000 + parseInt(mill);\r\n                    if (isNaN(Number(mill))) {\r\n                        mill = item.slice(7, 9);\r\n                        lrc = item.slice(10, item.length);\r\n                        time = parseInt(min) * 60 * 1000 + parseInt(sec) * 1000 + parseInt(mill);\r\n                    }\r\n                    return { min, sec, mill, lrc, time }\r\n                })\r\n                arr.forEach((item, i) => {\r\n                    if (i === arr.length - 1 || isNaN(arr[i+1].time)) {\r\n                        item.next = 10000\r\n\r\n                    } else {\r\n                        item.next = arr[i + 1].time\r\n                    }\r\n                })\r\n                return { arr }\r\n            }\r\n\r\n        }\r\n\r\n    },\r\n    mounted() {\r\n        this.addDuration()\r\n    },\r\n    watch: { \r\n        currentTime(val) {\r\n            let p = document.documentElement.querySelector('p.active');\r\n            if (p.offsetTop > 300 && p) {\r\n                this.$refs.musicLyric.scrollTop = p.offsetTop - 300\r\n            }\r\n\r\n            if(val===this.duration){\r\n                    if(this.playListIndex===this.playList.length-1){\r\n                        this.updatePlayListIndex(0)\r\n                    }else{\r\n                        this.updatePlayListIndex(0)\r\n                    }\r\n\r\n\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n    components: {\r\n        Vue3Marquee\r\n    },\r\n    methods: {\r\n        backHome() {\r\n            this.updatesonglistmore();\r\n            this.isLyricShow = false\r\n        },\r\n        goPlay(num) {\r\n            let index = this.playListIndex + num\r\n            if (index < 0) {\r\n                index = this.playList.length - 1;\r\n            } else if (index = this.playList.length - 1) {\r\n                index = 0\r\n            }\r\n            this.updatePlayListIndex(index)\r\n        },\r\n        ...mapMutations(['updatesonglistmore', 'updatePlayListIndex'])\r\n    },\r\n    props: ['musiclist', 'play', 'isbtnShow','addDuration']\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.bgimg {\r\n    width: 100%;\r\n    height: 100%;\r\n    position: absolute;\r\n    z-index: -1;\r\n    filter: blur(70px);\r\n}\r\n\r\n.detailTop {\r\n    width: 100%;\r\n    height: 1rem;\r\n    display: flex;\r\n    padding: 0.2rem;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    fill: #fff;\r\n\r\n\r\n    .topleft {\r\n        width: 90%;\r\n        display: flex;\r\n        align-items: center;\r\n\r\n        .leftMarquee {\r\n            height: 100%;\r\n            margin-left: 0.4rem;\r\n\r\n            span {\r\n                color: #999;\r\n\r\n            }\r\n\r\n            .sonMarquee {\r\n\r\n                display: flex;\r\n                align-items: center;\r\n\r\n                .arname {\r\n                    color: black\r\n                }\r\n            }\r\n        }\r\n\r\n        .marquee {\r\n            width: 100%;\r\n        }\r\n    }\r\n\r\n    .icon3 {\r\n        width: 0.55rem;\r\n        height: 0.55rem;\r\n\r\n    }\r\n\r\n    .icon2 {\r\n        width: 0.35rem;\r\n        height: 0.35rem;\r\n        fill: #999;\r\n\r\n\r\n    }\r\n\r\n    .icon1 {\r\n        width: .5rem;\r\n        height: .5rem;\r\n    }\r\n}\r\n\r\n.Musiclyric {\r\n    width: 100%;\r\n    height: 8rem;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    margin-top: .2rem;\r\n    overflow: scroll;\r\n\r\n    p {\r\n        color: rgb(190, 181, 181);\r\n        margin-bottom: .4rem;\r\n    }\r\n\r\n    .active {\r\n        color: #fff;\r\n        font-size: .5rem;\r\n        transition: .5s;\r\n    }\r\n\r\n}\r\n\r\n.detailContent {\r\n    width: 100%;\r\n    height: 9rem;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    position: relative;\r\n\r\n    .img_needle {\r\n        width: 2rem;\r\n        height: 3rem;\r\n        position: absolute;\r\n        left: 46%;\r\n        transition: all 2s;\r\n\r\n        transform-origin: 0 0;\r\n        transform: rotate(-13deg);\r\n\r\n    }\r\n\r\n    .img_needle_active {\r\n        width: 2rem;\r\n        height: 3rem;\r\n        position: absolute;\r\n        left: 46%;\r\n        transition: all 2s;\r\n\r\n        transform-origin: 0 0;\r\n        transform: rotate(0deg);\r\n\r\n    }\r\n\r\n    .img_cd {\r\n        width: 5rem;\r\n        height: 5rem;\r\n        position: absolute;\r\n        bottom: 2.3rem;\r\n        z-index: -1;\r\n    }\r\n\r\n    .img_ar {\r\n        width: 3.2rem;\r\n        height: 3.2rem;\r\n        border-radius: 50%;\r\n        position: absolute;\r\n        bottom: 3.14rem;\r\n        animation: rotate_ar 30s linear infinite;\r\n    }\r\n\r\n    .img_ar_active {\r\n        animation-play-state: running;\r\n    }\r\n\r\n    .img_ar_pause {\r\n        animation-play-state: paused;\r\n    }\r\n\r\n    @keyframes rotate_ar {\r\n        0% {\r\n            transform: rotateZ(0deg);\r\n        }\r\n\r\n        100% {\r\n            transform: rotateZ(360deg);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n.detailFooter {\r\n    width: 100%;\r\n    height: 3rem;\r\n    position: absolute;\r\n    bottom: .2rem;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n\r\n    .footerTop {\r\n        width: 100%;\r\n        height: 1rem;\r\n        display: flex;\r\n        justify-content: space-around;\r\n        align-items: center;\r\n\r\n        .icon5 {\r\n            width: .6rem;\r\n            height: .6rem;\r\n            fill: rgb(245, 245, 245)\r\n        }\r\n    }\r\n\r\n    .footerContent{\r\n        .range{\r\n            width: 100%;\r\n            height: .06rem;\r\n        }\r\n    }\r\n\r\n    .footer {\r\n        width: 100%;\r\n        height: 1rem;\r\n        display: flex;\r\n        justify-content: space-around;\r\n        align-items: center;\r\n\r\n        .icon5 {\r\n            width: .6rem;\r\n            height: .6rem;\r\n            fill: rgb(245, 245, 245);\r\n        }\r\n\r\n        .spc {\r\n            width: .95rem;\r\n            height: .95rem;\r\n            fill: rgb(245, 245, 245);\r\n        }\r\n\r\n    }\r\n}\r\n</style>"],"mappings":"AA2FA,SAASA,WAAU,QAAS,cAAa;AACzC,OAAO,6BAA4B;AACnC,SAASC,YAAY,EAAEC,QAAO,QAAS,MAAK;AAC5C,eAAe;EACXC,IAAIA,CAAA,EAAG;IACH,OAAO;MACHC,WAAW,EAAE;IACjB;EACJ,CAAC;EACDC,QAAQ,EAAE;IACN,GAAGH,QAAQ,CAAC,CAAC,WAAW,EAAE,aAAa,EAAE,eAAe,EAAE,UAAU,EAAC,UAAU,CAAC,CAAC;IACjF;;;;;;;;;;;IAWAI,QAAQA,CAAA,EAAG;MACP,IAAI,IAAI,CAACC,SAAS,CAACC,KAAK,EAAE;QACtB,IAAIC,GAAE,GAAI,IAAI,CAACF,SAAS,CAACC,KAAK,CAACE,KAAK,CAAC,eAAe,CAAC,CAACC,GAAG,CAAC,CAACC,IAAI,EAAEC,CAAC,KAAK;UACnE,IAAIC,GAAE,GAAIF,IAAI,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;UAC1B,IAAIC,GAAE,GAAIJ,IAAI,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;UAC1B,IAAIE,IAAG,GAAIL,IAAI,CAACG,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;UAC5B,IAAIG,GAAE,GAAIN,IAAI,CAACG,KAAK,CAAC,EAAE,EAAEH,IAAI,CAACO,MAAM,CAAC;UACrC,IAAIC,IAAG,GAAIC,QAAQ,CAACP,GAAG,IAAI,EAAC,GAAI,IAAG,GAAIO,QAAQ,CAACL,GAAG,IAAI,IAAG,GAAIK,QAAQ,CAACJ,IAAI,CAAC;UAC5E,IAAIK,KAAK,CAACC,MAAM,CAACN,IAAI,CAAC,CAAC,EAAE;YACrBA,IAAG,GAAIL,IAAI,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;YACvBG,GAAE,GAAIN,IAAI,CAACG,KAAK,CAAC,EAAE,EAAEH,IAAI,CAACO,MAAM,CAAC;YACjCC,IAAG,GAAIC,QAAQ,CAACP,GAAG,IAAI,EAAC,GAAI,IAAG,GAAIO,QAAQ,CAACL,GAAG,IAAI,IAAG,GAAIK,QAAQ,CAACJ,IAAI,CAAC;UAC5E;UACA,OAAO;YAAEH,GAAG;YAAEE,GAAG;YAAEC,IAAI;YAAEC,GAAG;YAAEE;UAAK;QACvC,CAAC;QACDX,GAAG,CAACe,OAAO,CAAC,CAACZ,IAAI,EAAEC,CAAC,KAAK;UACrB,IAAIA,CAAA,KAAMJ,GAAG,CAACU,MAAK,GAAI,KAAKG,KAAK,CAACb,GAAG,CAACI,CAAC,GAAC,CAAC,CAAC,CAACO,IAAI,CAAC,EAAE;YAC9CR,IAAI,CAACa,IAAG,GAAI,KAAI;UAEpB,OAAO;YACHb,IAAI,CAACa,IAAG,GAAIhB,GAAG,CAACI,CAAA,GAAI,CAAC,CAAC,CAACO,IAAG;UAC9B;QACJ,CAAC;QACD,OAAO;UAAEX;QAAI;MACjB;IAEJ;EAEJ,CAAC;EACDiB,OAAOA,CAAA,EAAG;IACN,IAAI,CAACC,WAAW,EAAC;EACrB,CAAC;EACDC,KAAK,EAAE;IACHC,WAAWA,CAACC,GAAG,EAAE;MACb,IAAIC,CAAA,GAAIC,QAAQ,CAACC,eAAe,CAACC,aAAa,CAAC,UAAU,CAAC;MAC1D,IAAIH,CAAC,CAACI,SAAQ,GAAI,GAAE,IAAKJ,CAAC,EAAE;QACxB,IAAI,CAACK,KAAK,CAACC,UAAU,CAACC,SAAQ,GAAIP,CAAC,CAACI,SAAQ,GAAI,GAAE;MACtD;MAEA,IAAGL,GAAG,KAAG,IAAI,CAACS,QAAQ,EAAC;QACf,IAAG,IAAI,CAACC,aAAa,KAAG,IAAI,CAACC,QAAQ,CAACtB,MAAM,GAAC,CAAC,EAAC;UAC3C,IAAI,CAACuB,mBAAmB,CAAC,CAAC;QAC9B,CAAC,MAAI;UACD,IAAI,CAACA,mBAAmB,CAAC,CAAC;QAC9B;MAGR;IACJ;EAGJ,CAAC;EACDC,UAAU,EAAE;IACR3C;EACJ,CAAC;EACD4C,OAAO,EAAE;IACLC,QAAQA,CAAA,EAAG;MACP,IAAI,CAACC,kBAAkB,EAAE;MACzB,IAAI,CAAC1C,WAAU,GAAI,KAAI;IAC3B,CAAC;IACD2C,MAAMA,CAACC,GAAG,EAAE;MACR,IAAIC,KAAI,GAAI,IAAI,CAACT,aAAY,GAAIQ,GAAE;MACnC,IAAIC,KAAI,GAAI,CAAC,EAAE;QACXA,KAAI,GAAI,IAAI,CAACR,QAAQ,CAACtB,MAAK,GAAI,CAAC;MACpC,OAAO,IAAI8B,KAAI,GAAI,IAAI,CAACR,QAAQ,CAACtB,MAAK,GAAI,CAAC,EAAE;QACzC8B,KAAI,GAAI;MACZ;MACA,IAAI,CAACP,mBAAmB,CAACO,KAAK;IAClC,CAAC;IACD,GAAGhD,YAAY,CAAC,CAAC,oBAAoB,EAAE,qBAAqB,CAAC;EACjE,CAAC;EACDiD,KAAK,EAAE,CAAC,WAAW,EAAE,MAAM,EAAE,WAAW,EAAC,aAAa;AAC1D"},"metadata":{},"sourceType":"module","externalDependencies":[]}